# Lumi Web Server

Lumi Web Serverは、Lumiデバイスをローカルネットワーク上で遠隔操作するための機能を提供します。

## 機能

- WiFi接続によるネットワーク機能
- Webインターフェースによる遠隔操作
- LED制御API
- パターン制御API

## セットアップ方法

### 1. WiFi設定

WiFi接続情報を設定するには、以下の手順に従ってください：

1. `data/wifi_config.json.example` ファイルを `data/wifi_config.json` にコピーします
2. `wifi_config.json` ファイルを編集して、あなたのWiFiネットワークのSSIDとパスワードを設定します

```json
{
  "ssid": "あなたのWiFi SSID",
  "password": "あなたのWiFiパスワード"
}
```

### 2. ファイルシステムのアップロード

Webインターフェースのファイル（HTML、CSS、JavaScript）をデバイスにアップロードするには、PlatformIOの「Upload Filesystem Image」機能を使用します：

1. PlatformIO IDEのサイドバーを開きます
2. 「Platform」セクションを展開します
3. 「Upload Filesystem Image」をクリックします

### 3. ファームウェアのビルドとアップロード

1. PlatformIO IDEのサイドバーを開きます
2. 「Build」ボタンをクリックしてプロジェクトをビルドします
3. 「Upload」ボタンをクリックしてファームウェアをデバイスにアップロードします

## 使用方法

1. デバイスの電源を入れると、自動的にWiFiネットワークに接続します
2. 接続が成功すると、シリアルモニターにデバイスのIPアドレスが表示されます
3. ブラウザでそのIPアドレスにアクセスすると、Webインターフェースが表示されます

## Webインターフェース

Webインターフェースでは以下の操作が可能です：

- 特定の面のLEDを制御（色の選択と適用）
- LEDパターンの実行と停止
- 全てのLEDのリセット

## API仕様

### ステータスAPI

- エンドポイント: `/api/status`
- メソッド: GET
- 説明: デバイスの現在のステータスを取得します

### LED制御API

- エンドポイント: `/api/led/face/{id}`
- メソッド: POST
- パラメータ:
  - `id`: 面のID（0-7）
  - `r`: 赤色の値（0-255）
  - `g`: 緑色の値（0-255）
  - `b`: 青色の値（0-255）
- 説明: 特定の面のLEDを指定した色に設定します

### パターン制御API

- エンドポイント: `/api/led/pattern/{id}`
- メソッド: POST
- パラメータ:
  - `id`: パターンのID
- 説明: 指定したLEDパターンを実行します

- エンドポイント: `/api/led/stop`
- メソッド: POST
- 説明: 現在実行中のLEDパターンを停止します

- エンドポイント: `/api/led/reset`
- メソッド: POST
- 説明: 全てのLEDをリセットします

- エンドポイント: `/api/led/patterns`
- メソッド: GET
- 説明: 利用可能なLEDパターンのリストを取得します

## トラブルシューティング

### WiFi接続の問題

- WiFi設定が正しいことを確認してください
- デバイスがWiFiルーターの範囲内にあることを確認してください
- シリアルモニターで接続ステータスを確認してください

### Webサーバーの問題

- デバイスのIPアドレスが正しいことを確認してください
- ファイルシステムが正しくアップロードされていることを確認してください
- シリアルモニターでWebサーバーの初期化ステータスを確認してください
